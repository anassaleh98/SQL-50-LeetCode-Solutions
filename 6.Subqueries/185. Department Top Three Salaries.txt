with ranked as(
    select   id, name, salary, departmentId,
    dense_rank() over(partition by departmentId order by salary desc) as rnk

    from Employee 
)
select d.name  as Department,
       r.name as Employee,
       r.Salary as Salary 
    from ranked r join Department  d
    on r.departmentId = d.id 
    where rnk <= 3
    ORDER BY d.name